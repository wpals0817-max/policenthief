# 테스트 시나리오

**프로젝트:** Policenthief  
**버전:** v1.0.0  
**최종 업데이트:** 2026-02-11

---

## 🧪 테스트 환경 준비

### 필수 준비물
- [ ] 2대 이상의 스마트폰 (iOS 또는 Android)
- [ ] GPS가 활성화된 환경 (야외 권장)
- [ ] 안정적인 인터넷 연결 (4G/5G 또는 Wi-Fi)
- [ ] 각 디바이스에서 위치 권한 허용

### 권장 환경
- **테스트 장소:** 50m x 50m 이상의 야외 공간 (공원, 운동장 등)
- **날씨:** 맑은 날 (GPS 정확도 향상)
- **시간대:** 위성 신호가 좋은 시간대
- **인원:** 최소 2명 (경찰 1명, 도둑 1명), 권장 3~4명

---

## 📋 테스트 체크리스트

### ✅ 기본 기능 테스트

#### 1. PWA 설치 및 실행
**목적:** 앱 설치 및 기본 화면 확인

**절차:**
1. 브라우저에서 앱 URL 접속 (https://your-domain.vercel.app)
2. "홈 화면에 추가" 또는 "설치" 프롬프트 확인
3. 설치 후 홈 화면 아이콘 확인 (🚔 아이콘)
4. 앱 실행 및 메인 화면 로드

**예상 결과:**
- ✅ PWA 설치 프롬프트 표시
- ✅ 홈 화면에 아이콘 추가
- ✅ 앱 실행 시 메인 화면 정상 표시
- ✅ 위치 권한 요청 팝업

---

#### 2. 방 생성 및 설정
**목적:** 게임 방 생성 및 설정 저장 확인

**절차:**
1. "방 만들기" 버튼 클릭
2. 닉네임 입력 (예: "경찰장")
3. 게임 설정 구성:
   - 경찰 수: 1명
   - 도둑 수: 1명
   - 게임 시간: 5분
   - 숨는 시간: 30초
   - 경계 반경: 50m
   - 구출 기능: 활성화
4. "방 만들기" 클릭
5. 생성된 방 코드 확인 (6자리)

**예상 결과:**
- ✅ 방 코드 생성 (예: ABC123)
- ✅ 방 대기실 화면으로 이동
- ✅ 호스트(자신)가 플레이어 목록에 표시
- ✅ QR 코드 및 공유 링크 표시

---

#### 3. 방 참가
**목적:** 다른 플레이어의 방 참가 기능 확인

**절차 (디바이스 2):**
1. 메인 화면에서 "방 참가하기" 클릭
2. 방 코드 입력 또는 QR 코드 스캔
3. 닉네임 입력 (예: "도둑1")
4. "참가하기" 클릭

**예상 결과:**
- ✅ 방 대기실로 입장
- ✅ 기존 플레이어(호스트) 목록에 표시
- ✅ 디바이스 1의 화면에도 새 플레이어 표시 (실시간 동기화)
- ✅ 플레이어 수 업데이트

---

#### 4. 팀 배정
**목적:** 경찰/도둑 팀 자동 배정 확인

**절차:**
1. 모든 플레이어가 참가한 후 대기
2. 호스트가 "게임 시작" 버튼 클릭
3. 팀 배정 결과 확인

**예상 결과:**
- ✅ 각 플레이어에게 경찰 또는 도둑 배정
- ✅ 배정된 팀에 따라 화면 색상 변경 (경찰: 파랑, 도둑: 빨강)
- ✅ 게임 화면으로 자동 전환

---

### 🎮 핵심 게임 로직 테스트

#### 5. 실시간 위치 동기화 ⭐
**목적:** Firebase Realtime Database 위치 공유 확인

**절차:**
1. 게임 시작 후 지도 화면 확인
2. 각 디바이스에서 다른 플레이어의 마커 표시 확인
3. 한 플레이어가 이동
4. 다른 플레이어의 화면에서 실시간 위치 업데이트 확인

**예상 결과:**
- ✅ 모든 플레이어의 위치가 지도에 표시
- ✅ 이동 시 3초 이내에 다른 화면에 반영
- ✅ 경찰은 파란색 마커, 도둑은 빨간색 마커
- ✅ 자신의 위치는 특별한 아이콘으로 표시

**측정 지표:**
- 위치 업데이트 지연 시간: < 3초
- 마커 이동 부드러움
- 배터리 소모율

---

#### 6. 자동 체포 시스템 🚔
**목적:** 거리 기반 자동 체포 기능 확인

**절차:**
1. 게임 시작 후 숨는 시간 종료 대기
2. 경찰이 도둑에게 접근 (약 10m)
3. 계속 접근하여 5m 이내로 진입
4. 자동 체포 알림 및 상태 변화 확인

**예상 결과:**
- ✅ 5m 이내 진입 시 자동으로 도둑 체포
- ✅ "🚔 [도둑 이름]을(를) 체포했습니다!" 알림 표시
- ✅ 도둑의 화면에 "⛓️ 체포되었습니다" 오버레이
- ✅ 지도에서 도둑 마커 색상/아이콘 변경
- ✅ 경찰의 체포 카운트 증가

**테스트 케이스:**
| 거리 | 예상 동작 |
|------|----------|
| 10m | 체포 안됨 |
| 7m | 체포 안됨 |
| 5m | ✅ 자동 체포 |
| 3m | ✅ 자동 체포 (이미 체포됨) |

**Edge Cases:**
- [ ] GPS 오차로 거리가 튀는 경우
- [ ] 두 경찰이 동시에 한 도둑에게 접근하는 경우
- [ ] 이미 체포된 도둑에게 재접근하는 경우

---

#### 7. 자동 구출 시스템 🦸
**목적:** 감옥 근처 자동 구출 기능 확인

**전제 조건:**
- 도둑이 최소 1명 체포되어 있음
- 감옥 위치가 설정되어 있음
- 구출 기능이 활성화되어 있음

**절차:**
1. 도둑 1명이 체포당함
2. 다른 살아있는 도둑이 감옥 위치로 이동 (약 10m)
3. 계속 접근하여 3m 이내로 진입
4. 자동 구출 알림 및 상태 변화 확인

**예상 결과:**
- ✅ 3m 이내 진입 시 자동으로 체포된 도둑 구출
- ✅ "🦸 [도둑 이름]을(를) 구출했습니다!" 알림 표시
- ✅ 구출된 도둑이 다시 "살아있음" 상태로 변경
- ✅ 구출된 도둑의 오버레이 사라짐
- ✅ 구출한 도둑의 구출 카운트 증가

**테스트 케이스:**
| 거리 | 예상 동작 |
|------|----------|
| 10m | 구출 안됨 |
| 5m | 구출 안됨 |
| 3m | ✅ 자동 구출 |
| 1m | ✅ 자동 구출 (이미 구출됨) |

**다방구 모드 테스트:**
1. 설정에서 "다방구" 모드 활성화
2. 여러 도둑이 체포된 상태
3. 살아있는 도둑이 감옥 3m 이내 접근
4. 구출할 도둑 선택 UI 표시 확인
5. 선택 후 구출 진행

---

#### 8. 경계 이탈 자동 탈락 🚫
**목적:** 15초 규칙 경계 이탈 탈락 확인

**절차:**
1. 게임 중 한 플레이어가 경계 밖으로 이동
2. 경고 알림 확인
3. 5초 후 추가 경고 확인
4. 10초 후 최종 경고 확인
5. 15초 경과 후 자동 탈락 확인

**예상 결과:**
- ✅ 경계 이탈 즉시 "⚠️ 경계 이탈! 15초 안에 돌아오세요!" 알림
- ✅ 상단에 빨간색 경고 배너 표시 (카운트다운)
- ✅ 5초 시점: "10초 안에 돌아오지 않으면 탈락!" 알림
- ✅ 10초 시점: "5초 안에 돌아오지 않으면 탈락합니다!" 알림
- ✅ 15초 경과: "🚫 경계를 벗어나 탈락했습니다!" 알림
- ✅ 화면에 "탈락하였습니다" 오버레이 표시
- ✅ 플레이어 상태 "disconnected"로 변경
- ✅ 다른 플레이어 화면에도 반영

**Edge Cases:**
- [ ] 경계 밖 14초 후 다시 들어오는 경우 (카운트 리셋)
- [ ] 경계선 근처에서 GPS 오차로 반복 이탈하는 경우
- [ ] 탈락 후 다시 경계 안으로 들어오는 경우 (여전히 탈락 상태)

---

#### 9. 게임 종료 조건
**목적:** 다양한 종료 시나리오 확인

**시나리오 A: 모든 도둑 체포**
1. 게임 중 경찰이 모든 도둑을 체포
2. 즉시 게임 종료 및 결과 화면 이동
3. 승자: 경찰

**시나리오 B: 시간 초과 (도둑 승리)**
1. 게임 시간이 모두 경과
2. 살아있는 도둑이 1명 이상
3. 즉시 게임 종료 및 결과 화면 이동
4. 승자: 도둑

**시나리오 C: 시간 초과 (경찰 승리)**
1. 게임 시간이 모두 경과
2. 살아있는 도둑이 0명
3. 즉시 게임 종료 및 결과 화면 이동
4. 승자: 경찰

**예상 결과:**
- ✅ 종료 조건 만족 시 즉시 결과 화면으로 전환
- ✅ 모든 디바이스가 동시에 전환
- ✅ 결과 화면에 승자, 게임 통계 표시
- ✅ 각 플레이어의 이동 거리, 체포/구출 수 표시

---

### 🔧 성능 및 안정성 테스트

#### 10. 배터리 소모 테스트
**목적:** 위치 추적으로 인한 배터리 소모 확인

**절차:**
1. 게임 시작 전 배터리 잔량 확인 (예: 100%)
2. 10분간 게임 진행
3. 게임 종료 후 배터리 잔량 확인

**예상 결과:**
- ✅ 10분 게임 시 배터리 소모 < 5%
- ✅ 백그라운드에서도 위치 추적 지속 (iOS 제한 확인)

---

#### 11. 네트워크 불안정 테스트
**목적:** 네트워크 오류 처리 확인

**절차:**
1. 게임 중 한 디바이스의 인터넷 연결 끊기 (비행기 모드)
2. 10초 후 다시 연결
3. 데이터 동기화 확인

**예상 결과:**
- ✅ 연결 끊김 시 위치 업데이트 중단
- ✅ 다른 플레이어 화면에서 해당 플레이어 마커 정지
- ✅ 재연결 시 즉시 위치 동기화 재개
- ✅ 에러 알림 표시 (선택)

---

#### 12. GPS 정확도 테스트
**목적:** 위치 정확도 및 체포/구출 정확성 확인

**절차:**
1. 두 디바이스를 정확히 5m 거리에 배치 (줄자 사용)
2. 자동 체포 발생 여부 확인
3. 3m, 7m 거리로 변경하며 반복

**예상 결과:**
- ✅ 5m 이내: 체포 발생
- ✅ 5m 초과: 체포 안됨
- ✅ GPS 오차 범위: ±3m 이내 (야외 기준)

**참고:**
- 실내에서는 GPS 정확도가 크게 떨어짐 (±10m 이상)
- 건물, 나무 등 장애물이 있으면 정확도 저하

---

### 🌐 다중 플레이어 테스트

#### 13. 3~4명 게임 테스트
**목적:** 다수 플레이어 동시 플레이 확인

**구성:**
- 경찰 1명, 도둑 3명
- 또는 경찰 2명, 도둑 2명

**절차:**
1. 모든 플레이어가 방에 참가
2. 게임 시작 후 각자 자유롭게 이동
3. 실시간 위치 동기화 확인
4. 체포/구출 진행
5. 게임 종료

**예상 결과:**
- ✅ 모든 플레이어의 위치가 정확히 표시
- ✅ 동시에 여러 체포/구출 발생 시 정상 처리
- ✅ Firebase 동기화 지연 < 3초
- ✅ 성능 저하 없음

---

#### 14. 동시 접근 테스트
**목적:** 여러 플레이어가 동시에 같은 대상과 상호작용하는 경우

**시나리오 A: 두 경찰이 한 도둑 동시 체포**
1. 경찰 2명이 동시에 도둑 5m 이내 접근
2. 체포 처리 확인

**예상 결과:**
- ✅ 도둑은 한 번만 체포됨 (중복 체포 방지)
- ✅ 두 경찰 모두 체포 카운트 증가 (또는 먼저 도달한 경찰만)

**시나리오 B: 도둑 구출 중 재체포**
1. 도둑 A가 체포된 도둑 B를 구출 중
2. 경찰이 도둑 A에게 접근하여 체포
3. 도둑 B의 상태 확인

**예상 결과:**
- ✅ 도둑 A 체포됨
- ✅ 도둑 B는 여전히 체포 상태 (구출 실패)

---

### 🐛 버그 재현 테스트

#### 15. 알려진 버그 확인

**버그 1: 지도 마커 중복 생성 (해결 필요)**
- [ ] 플레이어 위치 빠르게 변경 시 마커 중복 확인

**버그 2: 방 나가기 시 데이터 미정리 (해결 필요)**
- [ ] 방 나가기 후 다시 들어가면 이전 데이터 남는지 확인

**버그 3: 게임 시간 종료 후 알림 중복 (해결됨)**
- [ ] 타이머 종료 시 알림 중복 표시 여부 확인

---

## 📊 테스트 결과 기록 템플릿

### 테스트 보고서

**테스트 일시:** [날짜/시간]  
**테스트 환경:**
- 장소: [예: OO공원]
- 날씨: [예: 맑음]
- 디바이스:
  - 디바이스 1: [iPhone 15 Pro, iOS 17.2]
  - 디바이스 2: [Samsung Galaxy S24, Android 14]
- 플레이어 수: [예: 2명]

**테스트 결과:**

| 항목 | 상태 | 비고 |
|------|------|------|
| PWA 설치 | ✅ / ❌ | |
| 방 생성 | ✅ / ❌ | |
| 방 참가 | ✅ / ❌ | |
| 위치 동기화 | ✅ / ❌ | 평균 지연: 초 |
| 자동 체포 | ✅ / ❌ | 정확도: m |
| 자동 구출 | ✅ / ❌ | 정확도: m |
| 경계 이탈 탈락 | ✅ / ❌ | |
| 게임 종료 | ✅ / ❌ | |
| 배터리 소모 | ✅ / ❌ | 10분당 % |
| 네트워크 안정성 | ✅ / ❌ | |

**발견된 문제:**
1. [문제 설명]
2. [문제 설명]

**추가 의견:**
[자유 기술]

---

## 🎯 성공 기준

### 필수 기준 (배포 전)
- [ ] 실시간 위치 동기화 지연 < 5초
- [ ] 자동 체포 정확도 > 90%
- [ ] 자동 구출 정확도 > 90%
- [ ] 경계 이탈 탈락 정상 작동
- [ ] 게임 종료 조건 모두 정상 작동
- [ ] 치명적인 버그 없음

### 권장 기준
- [ ] 배터리 소모 < 5%/10분
- [ ] GPS 오차 < ±5m (야외)
- [ ] 네트워크 재연결 시 즉시 동기화
- [ ] 4명 이상 동시 플레이 가능

---

## 🔍 추가 테스트 시나리오

### 극한 상황 테스트

**1. 실내 테스트**
- GPS 신호가 약한 실내에서 게임 진행
- 위치 정확도 및 자동 체포/구출 작동 여부 확인

**2. 빠른 이동 테스트**
- 자전거, 자동차 등으로 빠르게 이동
- 위치 업데이트 및 경계 이탈 감지 확인

**3. 장시간 플레이 테스트**
- 30분 이상 게임 진행
- 메모리 누수, 배터리 소모, 성능 저하 확인

**4. 동시 다중 방 테스트**
- 여러 개의 방을 동시에 생성하고 게임 진행
- Firebase 부하 및 성능 확인

---

## 📝 피드백 수집 항목

**플레이어 만족도:**
- [ ] UI/UX가 직관적인가?
- [ ] 게임이 재미있는가?
- [ ] 자동 체포/구출이 공정한가?
- [ ] 경계 이탈 15초 규칙이 적절한가?
- [ ] 개선이 필요한 부분은?

**기능 요청:**
- [ ] 추가하고 싶은 기능
- [ ] 변경하고 싶은 규칙
- [ ] 불필요한 기능

---

## ✅ 최종 체크리스트

배포 전 반드시 확인:

- [ ] 모든 핵심 기능 정상 작동
- [ ] Firebase 보안 규칙 적용
- [ ] 실제 GPS 환경에서 테스트 완료
- [ ] 다중 플레이어 (2명 이상) 테스트 완료
- [ ] 배터리 소모 테스트 완료
- [ ] 치명적인 버그 없음
- [ ] 에러 처리 확인
- [ ] PWA 설치 및 실행 확인

---

**테스트 담당자:** [이름]  
**승인자:** [이름]  
**승인 일시:** [날짜/시간]

---

## 🎉 테스트 통과 시

**다음 단계:**
1. Firebase 보안 규칙 최종 확인
2. 프로덕션 배포 (Vercel)
3. 실제 사용자 테스트 (베타 테스트)
4. 피드백 수집 및 개선
5. v1.1 개발 시작

**축하합니다! 🎊**
